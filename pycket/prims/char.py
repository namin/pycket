#! /usr/bin/env python
# -*- coding: utf-8 -*-

from pycket.arity import Arity
from pycket.prims.expose import expose
from pycket.values import w_false, W_Fixnum, W_Bool, to_list

# FIXME: most probably totally wrong, copied directly from Racket
known_char_ranges = [
    [0, 887, False],
    [890, 895, False],
    [900, 906, False],
    [908, 908, True],
    [910, 929, False],
    [931, 1327, False],
    [1329, 1366, True],
    [1369, 1375, False],
    [1377, 1415, False],
    [1417, 1418, False],
    [1421, 1423, False],
    [1425, 1479, False],
    [1488, 1514, True],
    [1520, 1524, False],
    [1536, 1564, False],
    [1566, 1805, False],
    [1807, 1866, False],
    [1869, 1969, False],
    [1984, 2042, False],
    [2048, 2093, False],
    [2096, 2110, True],
    [2112, 2139, False],
    [2142, 2142, True],
    [2208, 2226, True],
    [2276, 2435, False],
    [2437, 2444, True],
    [2447, 2448, True],
    [2451, 2472, True],
    [2474, 2480, True],
    [2482, 2482, True],
    [2486, 2489, True],
    [2492, 2500, False],
    [2503, 2504, True],
    [2507, 2510, False],
    [2519, 2519, True],
    [2524, 2525, True],
    [2527, 2531, False],
    [2534, 2555, False],
    [2561, 2563, False],
    [2565, 2570, True],
    [2575, 2576, True],
    [2579, 2600, True],
    [2602, 2608, True],
    [2610, 2611, False],
    [2613, 2614, False],
    [2616, 2617, True],
    [2620, 2620, True],
    [2622, 2626, False],
    [2631, 2632, True],
    [2635, 2637, False],
    [2641, 2641, True],
    [2649, 2652, False],
    [2654, 2654, True],
    [2662, 2677, False],
    [2689, 2691, False],
    [2693, 2701, True],
    [2703, 2705, True],
    [2707, 2728, True],
    [2730, 2736, True],
    [2738, 2739, True],
    [2741, 2745, True],
    [2748, 2757, False],
    [2759, 2761, False],
    [2763, 2765, False],
    [2768, 2768, True],
    [2784, 2787, False],
    [2790, 2801, False],
    [2817, 2819, False],
    [2821, 2828, True],
    [2831, 2832, True],
    [2835, 2856, True],
    [2858, 2864, True],
    [2866, 2867, True],
    [2869, 2873, True],
    [2876, 2884, False],
    [2887, 2888, False],
    [2891, 2893, False],
    [2902, 2903, False],
    [2908, 2909, True],
    [2911, 2915, False],
    [2918, 2935, False],
    [2946, 2947, False],
    [2949, 2954, True],
    [2958, 2960, True],
    [2962, 2965, False],
    [2969, 2970, True],
    [2972, 2972, True],
    [2974, 2975, True],
    [2979, 2980, True],
    [2984, 2986, True],
    [2990, 3001, True],
    [3006, 3010, False],
    [3014, 3016, True],
    [3018, 3021, False],
    [3024, 3024, True],
    [3031, 3031, True],
    [3046, 3066, False],
    [3072, 3075, False],
    [3077, 3084, True],
    [3086, 3088, True],
    [3090, 3112, True],
    [3114, 3129, True],
    [3133, 3140, False],
    [3142, 3144, False],
    [3146, 3149, False],
    [3157, 3158, False],
    [3160, 3161, True],
    [3168, 3171, False],
    [3174, 3183, True],
    [3192, 3199, False],
    [3201, 3203, False],
    [3205, 3212, True],
    [3214, 3216, True],
    [3218, 3240, True],
    [3242, 3251, True],
    [3253, 3257, True],
    [3260, 3268, False],
    [3270, 3272, False],
    [3274, 3277, False],
    [3285, 3286, True],
    [3294, 3294, True],
    [3296, 3299, False],
    [3302, 3311, True],
    [3313, 3314, True],
    [3329, 3331, False],
    [3333, 3340, True],
    [3342, 3344, True],
    [3346, 3386, True],
    [3389, 3396, False],
    [3398, 3400, True],
    [3402, 3406, False],
    [3415, 3415, True],
    [3424, 3427, False],
    [3430, 3445, False],
    [3449, 3455, False],
    [3458, 3459, True],
    [3461, 3478, True],
    [3482, 3505, True],
    [3507, 3515, True],
    [3517, 3517, True],
    [3520, 3526, True],
    [3530, 3530, True],
    [3535, 3540, False],
    [3542, 3542, True],
    [3544, 3551, False],
    [3558, 3567, True],
    [3570, 3572, False],
    [3585, 3642, False],
    [3647, 3675, False],
    [3713, 3714, True],
    [3716, 3716, True],
    [3719, 3720, True],
    [3722, 3722, True],
    [3725, 3725, True],
    [3732, 3735, True],
    [3737, 3743, True],
    [3745, 3747, True],
    [3749, 3749, True],
    [3751, 3751, True],
    [3754, 3755, True],
    [3757, 3769, False],
    [3771, 3773, False],
    [3776, 3780, True],
    [3782, 3782, True],
    [3784, 3789, False],
    [3792, 3801, True],
    [3804, 3807, False],
    [3840, 3911, False],
    [3913, 3948, False],
    [3953, 3991, False],
    [3993, 4028, False],
    [4030, 4044, False],
    [4046, 4058, False],
    [4096, 4293, False],
    [4295, 4295, True],
    [4301, 4301, True],
    [4304, 4680, False],
    [4682, 4685, True],
    [4688, 4694, True],
    [4696, 4696, True],
    [4698, 4701, True],
    [4704, 4744, True],
    [4746, 4749, True],
    [4752, 4784, True],
    [4786, 4789, True],
    [4792, 4798, True],
    [4800, 4800, True],
    [4802, 4805, True],
    [4808, 4822, True],
    [4824, 4880, True],
    [4882, 4885, True],
    [4888, 4954, True],
    [4957, 4988, False],
    [4992, 5017, False],
    [5024, 5108, True],
    [5120, 5788, False],
    [5792, 5880, False],
    [5888, 5900, True],
    [5902, 5908, False],
    [5920, 5942, False],
    [5952, 5971, False],
    [5984, 5996, True],
    [5998, 6000, True],
    [6002, 6003, True],
    [6016, 6109, False],
    [6112, 6121, True],
    [6128, 6137, True],
    [6144, 6158, False],
    [6160, 6169, True],
    [6176, 6263, False],
    [6272, 6314, False],
    [6320, 6389, True],
    [6400, 6430, True],
    [6432, 6443, False],
    [6448, 6459, False],
    [6464, 6464, True],
    [6468, 6509, False],
    [6512, 6516, True],
    [6528, 6571, True],
    [6576, 6601, False],
    [6608, 6618, False],
    [6622, 6683, False],
    [6686, 6750, False],
    [6752, 6780, False],
    [6783, 6793, False],
    [6800, 6809, True],
    [6816, 6829, False],
    [6832, 6846, False],
    [6912, 6987, False],
    [6992, 7036, False],
    [7040, 7155, False],
    [7164, 7223, False],
    [7227, 7241, False],
    [7245, 7295, False],
    [7360, 7367, True],
    [7376, 7414, False],
    [7416, 7417, True],
    [7424, 7669, False],
    [7676, 7957, False],
    [7960, 7965, True],
    [7968, 8005, False],
    [8008, 8013, True],
    [8016, 8023, False],
    [8025, 8025, True],
    [8027, 8027, True],
    [8029, 8029, True],
    [8031, 8061, False],
    [8064, 8116, False],
    [8118, 8132, False],
    [8134, 8147, False],
    [8150, 8155, False],
    [8157, 8175, False],
    [8178, 8180, False],
    [8182, 8190, False],
    [8192, 8292, False],
    [8294, 8305, False],
    [8308, 8334, False],
    [8336, 8348, True],
    [8352, 8381, False],
    [8400, 8432, False],
    [8448, 8585, False],
    [8592, 9210, False],
    [9216, 9254, True],
    [9280, 9290, True],
    [9312, 11123, False],
    [11126, 11157, True],
    [11160, 11193, True],
    [11197, 11208, True],
    [11210, 11217, True],
    [11264, 11310, True],
    [11312, 11358, True],
    [11360, 11507, False],
    [11513, 11557, False],
    [11559, 11559, True],
    [11565, 11565, True],
    [11568, 11623, True],
    [11631, 11632, False],
    [11647, 11670, False],
    [11680, 11686, True],
    [11688, 11694, True],
    [11696, 11702, True],
    [11704, 11710, True],
    [11712, 11718, True],
    [11720, 11726, True],
    [11728, 11734, True],
    [11736, 11742, True],
    [11744, 11842, False],
    [11904, 11929, True],
    [11931, 12019, False],
    [12032, 12245, True],
    [12272, 12283, True],
    [12288, 12351, False],
    [12353, 12438, False],
    [12441, 12543, False],
    [12549, 12589, True],
    [12593, 12686, True],
    [12688, 12730, False],
    [12736, 12771, True],
    [12784, 12830, False],
    [12832, 13054, False],
    [13056, 19893, False],
    [19904, 40908, False],
    [40960, 42124, False],
    [42128, 42182, True],
    [42192, 42539, False],
    [42560, 42653, False],
    [42655, 42743, False],
    [42752, 42894, False],
    [42896, 42925, False],
    [42928, 42929, False],
    [42999, 43051, False],
    [43056, 43065, False],
    [43072, 43127, False],
    [43136, 43204, False],
    [43214, 43225, False],
    [43232, 43259, False],
    [43264, 43347, False],
    [43359, 43388, False],
    [43392, 43469, False],
    [43471, 43481, False],
    [43486, 43518, False],
    [43520, 43574, False],
    [43584, 43597, False],
    [43600, 43609, True],
    [43612, 43714, False],
    [43739, 43766, False],
    [43777, 43782, True],
    [43785, 43790, True],
    [43793, 43798, True],
    [43808, 43814, True],
    [43816, 43822, True],
    [43824, 43871, False],
    [43876, 43877, True],
    [43968, 44013, False],
    [44016, 44025, True],
    [44032, 55203, True],
    [55216, 55238, True],
    [55243, 55291, True],
    [57344, 64109, False],
    [64112, 64217, True],
    [64256, 64262, True],
    [64275, 64279, True],
    [64285, 64310, False],
    [64312, 64316, True],
    [64318, 64318, True],
    [64320, 64321, True],
    [64323, 64324, True],
    [64326, 64449, False],
    [64467, 64831, False],
    [64848, 64911, True],
    [64914, 64967, True],
    [65008, 65021, False],
    [65024, 65049, False],
    [65056, 65069, False],
    [65072, 65106, False],
    [65108, 65126, False],
    [65128, 65131, False],
    [65136, 65140, False],
    [65142, 65276, True],
    [65279, 65279, True],
    [65281, 65470, False],
    [65474, 65479, True],
    [65482, 65487, True],
    [65490, 65495, True],
    [65498, 65500, True],
    [65504, 65510, False],
    [65512, 65518, False],
    [65529, 65533, False],
    [65536, 65547, True],
    [65549, 65574, True],
    [65576, 65594, True],
    [65596, 65597, True],
    [65599, 65613, True],
    [65616, 65629, True],
    [65664, 65786, True],
    [65792, 65794, True],
    [65799, 65843, True],
    [65847, 65932, False],
    [65936, 65947, True],
    [65952, 65952, True],
    [66000, 66045, False],
    [66176, 66204, True],
    [66208, 66256, True],
    [66272, 66299, False],
    [66304, 66339, False],
    [66352, 66378, False],
    [66384, 66426, False],
    [66432, 66461, True],
    [66463, 66499, False],
    [66504, 66517, False],
    [66560, 66717, False],
    [66720, 66729, True],
    [66816, 66855, True],
    [66864, 66915, True],
    [66927, 66927, True],
    [67072, 67382, True],
    [67392, 67413, True],
    [67424, 67431, True],
    [67584, 67589, True],
    [67592, 67592, True],
    [67594, 67637, True],
    [67639, 67640, True],
    [67644, 67644, True],
    [67647, 67669, True],
    [67671, 67742, False],
    [67751, 67759, True],
    [67840, 67867, False],
    [67871, 67897, False],
    [67903, 67903, True],
    [67968, 68023, True],
    [68030, 68031, True],
    [68096, 68099, False],
    [68101, 68102, True],
    [68108, 68115, False],
    [68117, 68119, True],
    [68121, 68147, True],
    [68152, 68154, False],
    [68159, 68167, False],
    [68176, 68184, True],
    [68192, 68255, False],
    [68288, 68326, False],
    [68331, 68342, False],
    [68352, 68405, True],
    [68409, 68437, False],
    [68440, 68466, False],
    [68472, 68497, False],
    [68505, 68508, True],
    [68521, 68527, True],
    [68608, 68680, True],
    [69216, 69246, True],
    [69632, 69709, False],
    [69714, 69743, False],
    [69759, 69825, False],
    [69840, 69864, True],
    [69872, 69881, True],
    [69888, 69940, False],
    [69942, 69955, False],
    [69968, 70006, False],
    [70016, 70088, False],
    [70093, 70093, True],
    [70096, 70106, False],
    [70113, 70132, True],
    [70144, 70161, True],
    [70163, 70205, False],
    [70320, 70378, False],
    [70384, 70393, True],
    [70401, 70403, False],
    [70405, 70412, True],
    [70415, 70416, True],
    [70419, 70440, True],
    [70442, 70448, True],
    [70450, 70451, True],
    [70453, 70457, True],
    [70460, 70468, False],
    [70471, 70472, True],
    [70475, 70477, False],
    [70487, 70487, True],
    [70493, 70499, False],
    [70502, 70508, True],
    [70512, 70516, True],
    [70784, 70855, False],
    [70864, 70873, True],
    [71040, 71093, False],
    [71096, 71113, False],
    [71168, 71236, False],
    [71248, 71257, True],
    [71296, 71351, False],
    [71360, 71369, True],
    [71840, 71922, False],
    [71935, 71935, True],
    [72384, 72440, True],
    [73728, 74648, True],
    [74752, 74862, True],
    [74864, 74868, True],
    [77824, 78894, True],
    [92160, 92728, True],
    [92736, 92766, True],
    [92768, 92777, True],
    [92782, 92783, True],
    [92880, 92909, True],
    [92912, 92917, False],
    [92928, 92997, False],
    [93008, 93017, True],
    [93019, 93025, True],
    [93027, 93047, True],
    [93053, 93071, True],
    [93952, 94020, True],
    [94032, 94078, False],
    [94095, 94111, False],
    [110592, 110593, True],
    [113664, 113770, True],
    [113776, 113788, True],
    [113792, 113800, True],
    [113808, 113817, True],
    [113820, 113827, False],
    [118784, 119029, True],
    [119040, 119078, True],
    [119081, 119261, False],
    [119296, 119365, False],
    [119552, 119638, True],
    [119648, 119665, True],
    [119808, 119892, False],
    [119894, 119964, False],
    [119966, 119967, True],
    [119970, 119970, True],
    [119973, 119974, True],
    [119977, 119980, True],
    [119982, 119993, False],
    [119995, 119995, True],
    [119997, 120003, True],
    [120005, 120069, False],
    [120071, 120074, True],
    [120077, 120084, True],
    [120086, 120092, True],
    [120094, 120121, False],
    [120123, 120126, True],
    [120128, 120132, True],
    [120134, 120134, True],
    [120138, 120144, True],
    [120146, 120485, False],
    [120488, 120779, False],
    [120782, 120831, True],
    [124928, 125124, True],
    [125127, 125142, False],
    [126464, 126467, True],
    [126469, 126495, True],
    [126497, 126498, True],
    [126500, 126500, True],
    [126503, 126503, True],
    [126505, 126514, True],
    [126516, 126519, True],
    [126521, 126521, True],
    [126523, 126523, True],
    [126530, 126530, True],
    [126535, 126535, True],
    [126537, 126537, True],
    [126539, 126539, True],
    [126541, 126543, True],
    [126545, 126546, True],
    [126548, 126548, True],
    [126551, 126551, True],
    [126553, 126553, True],
    [126555, 126555, True],
    [126557, 126557, True],
    [126559, 126559, True],
    [126561, 126562, True],
    [126564, 126564, True],
    [126567, 126570, True],
    [126572, 126578, True],
    [126580, 126583, True],
    [126585, 126588, True],
    [126590, 126590, True],
    [126592, 126601, True],
    [126603, 126619, True],
    [126625, 126627, True],
    [126629, 126633, True],
    [126635, 126651, True],
    [126704, 126705, True],
    [126976, 127019, True],
    [127024, 127123, True],
    [127136, 127150, True],
    [127153, 127167, True],
    [127169, 127183, True],
    [127185, 127221, True],
    [127232, 127244, False],
    [127248, 127278, True],
    [127280, 127339, False],
    [127344, 127386, False],
    [127462, 127490, False],
    [127504, 127546, True],
    [127552, 127560, True],
    [127568, 127569, True],
    [127744, 127788, True],
    [127792, 127869, True],
    [127872, 127950, True],
    [127956, 127991, True],
    [128000, 128254, True],
    [128256, 128330, True],
    [128336, 128377, True],
    [128379, 128419, True],
    [128421, 128578, True],
    [128581, 128719, True],
    [128736, 128748, True],
    [128752, 128755, True],
    [128768, 128883, True],
    [128896, 128980, True],
    [129024, 129035, True],
    [129040, 129095, True],
    [129104, 129113, True],
    [129120, 129159, True],
    [129168, 129197, True],
    [131072, 173782, True],
    [173824, 177972, True],
    [177984, 178205, True],
    [194560, 195101, False],
    [917505, 917505, True],
    [917536, 917631, True],
    [917760, 917999, True],
    [983040, 1048573, True],
    [1048576, 1114109, True]]

LEN_CHAR_RANGES = len(known_char_ranges)

@expose("make-known-char-range-list", arity=Arity.geq(0))
def make_known_char_range_list(args):
    all_known = [None]*LEN_CHAR_RANGES
    for i, (start, end, same_props) in enumerate(known_char_ranges):
        all_known[i] = to_list([W_Fixnum(start), W_Fixnum(end), W_Bool.make(same_props)])
    return to_list(all_known)
